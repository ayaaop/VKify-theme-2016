{extends "@layout.xml"}

{block title}
    {_edit}
{/block}

{block heading}
    {_edit} #{$form->token ?? "undefined"}
{/block}

{block afterHeader}
    {var $tabs = [
        [
            'url' => '#',
            'title' => 'admin_tab_main',
            'active' => true,
            'attrs' => ['data-tab' => 'info']
        ],
        [
            'url' => '#',
            'title' => 'voucher_activators',
            'active' => false,
            'attrs' => ['data-tab' => 'activators']
        ]
    ]}

    {include "../components/page_tabs_header.xml", tabs => $tabs, white => true}
{/block}

{block content}
    <div id="tab-info" class="admin-tab-content">
        <form method="POST">
            <div class="settings_panel clear_fix">
                <div class="settings_list_row">
                    <div class="settings_label">ID</div>
                    <div class="settings_labeled_text" dir="auto">{$form->id}</div>
                </div>
                <div class="settings_list_row">
                    <div class="settings_label">{_admin_voucher_serial}</div>
                    <div class="settings_labeled_text">
                        <input class="text long-field" type="text" id="token" name="token" value="{$form->token}" />
                        <div class="settings_help">{_admin_voucher_serial_desc}</div>
                    </div>
                </div>
                <div class="settings_list_row">
                    <div class="settings_label">{_admin_voucher_coins}</div>
                    <div class="settings_labeled_text">
                        <input class="text long-field" type="number" min="0" id="coins" name="coins" value="{$form->coins}" />
                    </div>
                </div>
                <div class="settings_list_row">
                    <div class="settings_label">{_admin_voucher_rating_number}</div>
                    <div class="settings_labeled_text">
                        <input class="text long-field" type="number" min="0" id="rating" name="rating" value="{$form->rating}" />
                    </div>
                </div>
                <div class="settings_list_row">
                    <div class="settings_label">
                        {if $form->id === 0}
                            {_usages_total}
                        {else}
                            {_usages_left}
                        {/if}
                    </div>
                    <div class="settings_labeled_text">
                        <input class="text long-field" type="number" min="-1" id="usages" name="usages" value="{$form->usages}" />
                        <div class="settings_help">{_admin_voucher_usages_desc}</div>
                    </div>
                </div>
                <div class="settings_list_row">
                    <div class="settings_label"></div>
                    <div class="settings_labeled_text">
                        <input type="hidden" name="hash" value="{$csrfToken}" />
                        <input class="button" type="submit" value="{_save}">
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div id="tab-activators" class="admin-tab-content" style="display: none;">
        <div class="page_padding">
            <div class="page_table_wrapper">
                <table class="page_table">
                    <tbody>
                        <tr n:foreach="$form->users as $user">
                            <td>
                                <span class="avatar">
                                    <img src="{$user->getAvatarUrl('miniscule')}" alt="{$user->getCanonicalName()}" role="presentation" />
                                </span>

                                <a href="{$user->getURL()}">{$user->getCanonicalName()}</a>

                                <span n:if="$user->isBanned()" class="ui_tab_count" style="background-color: #e74c3c; color: white;">{_admin_banned}</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{/block}
